@import "../_vars.less";
@import "../bootstrap/variables.less";
@import "../bootstrap/mixins.less";
@import "../leaflet.less";
@import "../leaflet.markercluster.less";

@spinVal: 250 / 110;
@yearBase: hsv(240, 100%, 67%);
.yearLooping(@index) when (@index < 2001) {
	(~".y@{index}") { // your resulting css
		@vall: (@index - 1890) * @spinVal;
		background-color: spin(@yearBase, @vall); //width: (~"@{vall}px");
	}
	.yearLooping(@index + 1); // next iteration
}
.yearLooping(2001) {}

@yearBaseOld: hsv(240, 100%, 50%);
.yearLoopingOld(@index) when (@index > 1799) {
	(~".y@{index}") {
		background-color: @yearBaseOld;
	}
	.yearLoopingOld(@index - 1); // next iteration
}
.yearLoopingOld(1799) {}

.photoIconHLAnimation() {
	to  { -webkit-box-shadow: 0 0 2px 2px #fab71e; }
}
@-webkit-keyframes photoIconHighlight {
	.photoIconHLAnimation();
}
@keyframes photoIconHighlight {
	.photoIconHLAnimation();
}

.mapModuleWrapper {
	position: relative;
	width: 100%;
	height: 100%;
	.user-select(none);

	.mapContainer {
		position: relative;
		width: 100%;
		height: 100%;
		overflow: hidden;
	}

	.map {
		position: relative;
		width: 100%;
		height: 100%;
		margin: 0;
		.user-select(none);
	}

	.mapNavigation {
		position: absolute;
		top: 10px;
		left: 3px;
	}

	.leaflet-popup {
		.transition(none);

		.leaflet-popup-content-wrapper {
			.border-radius(0);
			.box-shadow(0 1px 12px rgba(0, 0, 0, 0.6));

			.leaflet-popup-content {
				margin: 0;
			}
		}
		.leaflet-popup-content-wrapper, .leaflet-popup-tip {
			background-color: darken(@MainBlueColor, 3%);
		}
		.leaflet-popup-content-wrapper {
			padding-left: 0;
			padding-right: 0;
		}
		.leaflet-popup-content {
			text-align: center;
			padding-bottom: 1px;
		}
		.leaflet-popup-tip-container {
			height: 15px;

			.leaflet-popup-tip {
				.box-shadow(0px -2px 10px rgba(0, 0, 0, 0.6));
			}
		}

		.popupImg {
			display: block;
			margin: 0 1px;
			width: 150px;
			height: 100px;
		}

		.popupCap {
			display: block;
			max-height: 37px;
			padding: 1px 2px;
			color: @MainLigthColor;
			font-size: 11px;
			line-height: 12px;
			overflow: hidden;

			&:empty {
				display: none;
			}
		}

		&.popupPhoto {
		}

		&.popupCluster {
			.popupPoster {
				position: absolute;
				top: 1px;
				left: 0;
				width: 100%;
				cursor: pointer;
			}
			&.five.scroll .popupPoster {
				top: 2px;
			}

			&.five .popupImg {
				width: 246px;
				height: 164px;
			}
			&.five.scroll .popupImg {
				margin: 0 2px;
			}

			.popupPreviews {
				margin-top: 120px;
				&::-webkit-scrollbar {
					width: 12px;
				}
				&::-webkit-scrollbar-button:decrement {
					height: 0;
				}
			}
			&.five .popupPreviews {
				margin-top: 185px;
				max-height: 139px;
				overflow-y: auto;
			}

			.popupCap {
				.text-overflow();
			}
			.h_separatorWhite {
				margin: 2px 0 0 0;
			}

			.popupImgPreview {
				display: inline-block;
				width: 40px;
				height: 40px;
				margin: 2px 3px;
				cursor: pointer;
				.box-shadow(~'0 0 0 1px #000');

				&:hover {
					.box-shadow(~'0 0 0 1px black, 0 0px 2px 2px #fff');
				}
			}
			&.five.scroll .popupImgPreview {
				margin: 2px 2px;
			}
		}

	}

	.yearLoopingOld (1889);
	.yearLooping (1890);

	.photoIcon {
		overflow: visible;
		.box-shadow(0 0 1px 1px #fff);
		.border-radius(50%);

		&::after {
			display: none;
			position: absolute;
			content: '';
			background-image: url(/img/map/arr.png);
			background-repeat: no-repeat;
			width: 10px;
			height: 10px;
			pointer-events: none;
			/*width: 0;
			height: 0;
			border-style: solid;
			border-width: 0 3px 8px 3px;
			border-color: transparent transparent #000 transparent;
			.rotate(45deg);*/
		}

		&:hover, &.highlight {
			width: 12px !important;
			height: 12px !important;
			margin-left: -6px !important;
			margin-top: -6px !important;
			.box-shadow(0 0 2px 2px #fff);
		}
		&.highlight {
			background-image: url(/img/map/pointhl.png);
			background-repeat: no-repeat;
			background-position: 1px 1px;
			-webkit-animation: photoIconHighlight .7s linear 1s infinite alternate;
		}

		&.n {
			&::after {
				display: block;
				top: -10px;
				right: -1px;
				background-position: 0 0;
			}
			&:hover::after, &.highlight::after {
				top: -11px;
				right: 1px;
			}
		}
		&.ne {
			&::after {
				display: block;
				top: -7px;
				right: -6px;
				background-position: -10px 0;
			}
			&:hover::after, &.highlight::after {
				top: -7px;
				right: -6px;
			}
		}
		&.e {
			&::after {
				display: block;
				top: -1px;
				right: -10px;
				background-position: -20px 0;
			}
			&:hover::after, &.highlight::after {
				top: 1px;
				right: -11px;
			}
		}
		&.se {
			&::after {
				display: block;
				top: 5px;
				right: -6px;
				background-position: -30px 0;
			}
			&:hover::after, &.highlight::after {
				top: 9px;
				right: -6px;
			}
		}
		&.s {
			&::after {
				display: block;
				top: 8px;
				right: -1px;
				background-position: -40px 0;
			}
			&:hover::after, &.highlight::after {
				top: 13px;
				right: 1px;
			}
		}
		&.sw {
			&::after {
				display: block;
				top: 5px;
				right: 5px;
				background-position: -50px 0;
			}
			&:hover::after, &.highlight::after {
				top: 9px;
				right: 9px;
			}
		}
		&.w {
			&::after {
				display: block;
				top: -1px;
				right: 8px;
				background-position: -60px 0;
			}
			&:hover::after, &.highlight::after {
				top: 1px;
				right: 13px;
			}
		}
		&.nw {
			&::after {
				display: block;
				top: -7px;
				right: 5px;
				background-position: -70px 0;
			}
			&:hover::after, &.highlight::after {
				top: -7px;
				right: 9px;
			}
		}
	}

	.clusterIcon {
		opacity: 0; //border-color: #fff;
		.box-sizing(border-box);
		.transition(opacity .25s linear);

		.clusterImg {
			position: absolute;
			display: block;
			width: 100%;
		}

		.clusterCount {
			position: absolute;
			bottom: 0;
			width: 100%;
			color: #fff;
			text-align: center;
			line-height: 13px;
			font-size: 12px;
			font-weight: bold;
			text-shadow: 1px 1px 0 black, -1px 1px 0 black, 1px -1px 0 black, -1px -1px 0 black;
			.simple_gradient(transparent, rgba(0, 0, 0, 0.7));
		}

		&.show {
			opacity: 1;
		}
	}

	.clusterIconLocal { //background-color: #303030;
		color: #fff;
		line-height: 18px;
		font-size: 11px;
		font-weight: bold;
		font-family: Arial;
		text-align: center;
		.box-sizing(border-box);
		.box-shadow(0 0 1px 1px #fff);
		.border-radius(50%);

		&.m {
			line-height: 16px;
		}
		&.s {
			line-height: 12px;
		}
	}

/*.neoPopup {
	display: block;
	position: absolute;
	top: 100px;
	left: 150px;
	color: @MainLigthColor;
	font-size: 12px;
	border: 2px solid #f2f5ff;
	background-color: @MainBlueColor;
	-webkit-filter: drop-shadow(rgba(0,0,0,0.8) 1px 1px 1px);

	&::after, &::before {
		border: solid transparent;
		content: " ";
		height: 0;
		width: 0;
		position: absolute;
		pointer-events: none;
	}

	&::after {
		border-color: rgba(136, 183, 213, 0);
		border-width: 10px;
		left: 50%;
		margin-left: -10px;
	}
	&::before {
		border-color: rgba(195, 199, 221, 0);
		border-width: 13px;
		left: 50%;
		margin-left: -13px;
	}

	&.up {
		&::after, &::before {
			bottom: 100%;
		}
		&::after {
			border-bottom-color: @MainBlueColor;
		}
		&::before {
			border-bottom-color: #C3C7DD;
		}
	}

	&.down {
		&::after, &::before {
			top: 100%;
		}
		&::after {
			border-top-color: @MainBlueColor;
		}
		&::before {
			border-top-color: #C3C7DD;
		}
	}

}*/

/**
 * LAYER PANEL
 */
	.layersPanel {
		position: absolute;
		top: 20px;
		right: 7px;
		height: 24px;
		overflow: hidden;
		.user-select(none);
		.transition(height 0.7s ease-out);

		&.open {
			height: 175px;

			.layerSystems {
				opacity: 1;
			}
		}

		.currentLayer {
			position: relative;
			margin: 0;
			padding: 0 4px;
			white-space: nowrap;
			font-weight: bold;
			font-size: 18px;
			line-height: 24px;
			text-align: right;
			cursor: pointer;
		}

		.h_separator {
			position: relative;
			height: 1px;
			width: 100%;
			margin: 0 0 2px 0;
			filter: none;
			background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI4NTk5MSIgc3RvcC1vcGFjaXR5PSIwLjMiLz4KICAgIDxzdG9wIG9mZnNldD0iMTIlIiBzdG9wLWNvbG9yPSIjNzhhMmNjIiBzdG9wLW9wYWNpdHk9IjAuOCIvPgogICAgPHN0b3Agb2Zmc2V0PSI1MCUiIHN0b3AtY29sb3I9IiNmZmZmZmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogICAgPHN0b3Agb2Zmc2V0PSI4OCUiIHN0b3AtY29sb3I9IiM3OGEyY2MiIHN0b3Atb3BhY2l0eT0iMC44Ii8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMyODU5OTEiIHN0b3Atb3BhY2l0eT0iMC4zIi8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSJ1cmwoI2dyYWQtdWNnZy1nZW5lcmF0ZWQpIiAvPgo8L3N2Zz4=);
			background: -moz-linear-gradient(left, rgba(40, 89, 145, 0.3) 0%, rgba(120, 162, 204, 0.8) 12%, rgb(255, 255, 255) 50%, rgba(120, 162, 204, 0.8) 88%, rgba(40, 89, 145, 0.3) 100%); /* FF3.6+ */
			background: -webkit-gradient(linear, left top, right top, color-stop(0%, rgba(40, 89, 145, 0.3)), color-stop(12%, rgba(120, 162, 204, 0.8)), color-stop(50%, rgb(255, 255, 255)), color-stop(88%, rgba(120, 162, 204, 0.8)), color-stop(100%, rgba(40, 89, 145, 0.3))); /* Chrome,Safari4+ */
			background: -webkit-linear-gradient(left, rgba(40, 89, 145, 0.3) 0%, rgba(120, 162, 204, 0.8) 12%, rgb(255, 255, 255) 50%, rgba(120, 162, 204, 0.8) 88%, rgba(40, 89, 145, 0.3) 100%); /* Chrome10+,Safari5.1+ */
			background: -o-linear-gradient(left, rgba(40, 89, 145, 0.3) 0%, rgba(120, 162, 204, 0.8) 12%, rgb(255, 255, 255) 50%, rgba(120, 162, 204, 0.8) 88%, rgba(40, 89, 145, 0.3) 100%); /* Opera 11.10+ */
			background: -ms-linear-gradient(left, rgba(40, 89, 145, 0.3) 0%, rgba(120, 162, 204, 0.8) 12%, rgb(255, 255, 255) 50%, rgba(120, 162, 204, 0.8) 88%, rgba(40, 89, 145, 0.3) 100%); /* IE10+ */
			background: linear-gradient(to right, rgba(40, 89, 145, 0.3) 0%, rgba(120, 162, 204, 0.8) 12%, rgb(255, 255, 255) 50%, rgba(120, 162, 204, 0.8) 88%, rgba(40, 89, 145, 0.3) 100%); /* W3C */
		}

		.layerSystems {
			display: inline-block;
			position: relative;
			width: 104px;
			opacity: 0;
			overflow: hidden;
			white-space: nowrap;
			.transition(~'width 0.7s ease-in-out, opacity 0.7s ease-in-out');

			.layerSystem {
				display: inline-block;
				vertical-align: top;
				width: 100px;
				padding: 0 0 2px 0;
				border: 1px solid transparent;
				margin: 1px;
				position: relative;
			}

			.layerHead {
				position: relative;
				vertical-align: middle;
				text-align: center;
				font-weight: bold;
				font-size: 17px;
				line-height: 22px;
				border: 1px solid transparent;
				background: #5282c0;
				padding: 2px 0 1px;
				margin: 0 0 3px 0;

				&.selected {
					border-color: #C3C7DD;
				}
			}

			.layerType {
				border: 1px solid transparent;
				cursor: pointer;
				font-weight: normal;
				font-size: 17px;
				line-height: 17px;
				padding: 5px 4px;
				text-align: center;

				&:hover {
					border-color: #C3C7DD;
				}

				&.selected {
					.box-shadow(inset 0 1px 1px 1px #1C1C1C);
					background-color: #474747;
					border: 1px solid #707070;
				}
			}
		}
	}

	.linkOpenMode {
		position: absolute;
		right: 14px;
		bottom: 5px;
		white-space: nowrap;
	}

	.mapContainer.embedded {
		.mapNavigation {
			top: -33px;
			left: -13px;
		}

		.layersPanel {
			top: 5px;
			right: 4px;
		}
	}

	.leaflet-control-container {
		display: none;
	}
}


