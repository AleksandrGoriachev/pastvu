.user_settings(data-bind="with: repository[M!M]"): .panel-group#accordion
    .panel.panel-pastvu
        .panel-heading: .panel-title: a(data-toggle="collapse", href="#privacy") Конфиденциальность
        .panel-collapse.collapse.in#privacy: .panel-body
            dl.dl-horizontal
                dt Мой email
                dd: .row: .col-xs-9.col-sm-10.col-md-7.col-lg-4
                    .input-group
                        input.form-control(type="email", data-bind="attr: {size: u.email().length, disabled: !editEmail()}, value: u.email, valueUpdate: 'afterkeydown', executeOnEnter: saveEmail")
                        span.input-group-addon.action(data-bind="click: saveEmail, css: {save: editEmail()}")
                            span.glyphicon(data-bind="css: {'glyphicon-pencil': !editEmail(), 'glyphicon-ok': editEmail()}")
                        //ko if:editEmail()
                        span.input-group-addon.action.cancel(data-bind="click: cancelEmail, css: {save: editEmail()}")
                            span.glyphicon.glyphicon-remove
                        // /ko
            dl.dl-horizontal
                dt Мой пароль
                dd
                    //ko if: itsMe()
                    button.btn.btn-sm.btn-primary(type="button", title="Сменить текущий пароль", data-bind="event:{click: function(data, evt){auth.show('passChange')}}")
                        span Сменить
                    // /ko
                    button.btn.btn-sm.btn-primary(type="button", title="Сменить через почту без ввода текущего", data-bind="event:{click: function(data, evt){auth.showRecallRequest(u.login())}}")
                        span Запросить смену
            dl.dl-horizontal
                dt Показывать в обсуждениях реальное имя
                dd: .btn-group.btn-group-sm
                    button.btn.btn-primary.yes(type="button", data-bind="css: {active: showName()}, click: toggleDisp") Да
                    button.btn.btn-primary.no(type="button", data-bind="css: {active: !showName()}, click: toggleDisp") Нет

    .panel.panel-pastvu
        .panel-heading: .panel-title: a(data-toggle="collapse", href="#region") Регионы
        .panel-collapse.collapse.in#region: .panel-body
            dl.dl-horizontal
                dt.helpexists
                    abbr(title="Регион, который определяет некоторые настройки, например, позицию кнопки Домой на карте, первый элемент в списке выбора регионов и т.д.")
                        span.glyphicon.glyphicon-info-sign
                        | &nbsp;
                        span.glyphicon.glyphicon-home
                        |  Домашний регион
                dd
                    span.region
                        span(data-bind="text: u.regionHome.title_local()")
                    span.regionEdit(data-bind="click: regionHomeSelect")
                        span.glyphicon.glyphicon-pencil
                        | Изменить
            //ko if: u.role() === 5 && u.mod_regions()
            dl.dl-horizontal.forMod
                dt.helpexists
                    abbr(title="Регионы, в которых вы являетесь модератором. Назначаются администратором")
                        span.glyphicon.glyphicon-info-sign
                        |  Модерируемые мной регионы
                dd
                    //ko if: !u.mod_regions().length
                    span.region
                        span.glyphicon.glyphicon-globe
                        |  Весь мир
                    // /ko
                    //ko foreach: u.mod_regions
                    span.region
                        span(data-bind="text: $data.title_local()")
                    // /ko
            // /ko
            dl.dl-horizontal
                dt.helpexists
                    abbr(title="Регионы, по которым будет производится автоматическая фильтрация контента")
                        span.glyphicon.glyphicon-info-sign
                        | &nbsp;
                        span.glyphicon.glyphicon-filter
                        |  Фильтрация данных по умолчанию
                dd: span.panel-block
                    .radio(style="margin-top:0"): label
                        input(type="radio", name="regfilter_radios", value="all", data-bind="checked: regfiltercheck")
                        span.glyphicon.glyphicon-globe
                        |  Весь мир (без фильтра)
                    .radio: label
                        input(type="radio", name="regfilter_radios", value="home", data-bind="checked: regfiltercheck")
                        span.glyphicon.glyphicon-home
                        |  Домашний регион
                    .radio(style="margin-bottom:5px"): label
                        input(type="radio", name="regfilter_radios", value="list", data-bind="checked: regfiltercheck")
                        span.glyphicon.glyphicon-list
                        span  Список
                        //ko if: regfiltercheck() === 'list'
                        | :&nbsp;
                        //ko foreach: u.regions
                        span.region.candrop(title="Убрать из моих регионов", data-bind="click: function() {$parent.regionDrop($data.cid());}")
                            span(data-bind="text: $data.title_local()")
                        // /ko
                        //ko if: u.regions().length
                        span.regionEdit(data-bind="click: regionFilterSelect")
                            span.glyphicon.glyphicon-pencil
                            | Изменить
                        // /ko
                        // /ko
            dl.dl-horizontal
                dt.helpexists(style="color: #27578d;")
                    | По умолчанию фильтровать по выбранным регионам:
                dd
            dl.dl-horizontal.dl-tight
                dt.helpexists
                    abbr(title="Фотографии пользователей, доступые в соответствующих профилях")
                        span.glyphicon.glyphicon-info-sign
                        |  Галереи пользователей
                dd
                    .btn-group.btn-group-sm
                        button.btn.btn-primary.yes(type="button", data-bind="css: {active: u.settings.r_f_user_gal()}, click: regionUserGal") Да
                        button.btn.btn-primary.no(type="button", data-bind="css: {active: !u.settings.r_f_user_gal()}, click: regionUserGal") Нет
            dl.dl-horizontal.dl-tight
                dt.helpexists
                    abbr(title="Полоса фотографий, находящаяся рядом с именем пользователя, на странице просмотра загруженной им фотогафии")
                        span.glyphicon.glyphicon-info-sign
                        |  Полосу других фотографий пользователя
                dd
                    .btn-group.btn-group-sm
                        button.btn.btn-primary.yes(type="button", data-bind="css: {active: u.settings.r_f_photo_user_gal()}, click: regionPhotoUserGal") Да
                        button.btn.btn-primary.no(type="button", data-bind="css: {active: !u.settings.r_f_photo_user_gal()}, click: regionPhotoUserGal") Нет

    .panel.panel-pastvu
        .panel-heading: .panel-title: a(data-toggle="collapse", href="#photo") Фотографии
        .panel-collapse.collapse.in#notice: .panel-body
            dl.dl-horizontal
                dt.helpexists
                    abbr(title="Показывать по умолчанию вотермарк pastvu.com, встроенный в фотографию")
                        span.glyphicon.glyphicon-info-sign
                        |  Показывать вотермарк фотографии
                dd
                    .btn-group.btn-group-sm
                        button.btn.btn-primary.yes(type="button", data-bind="css: {active: u.settings.photo_show_watermark()}, click: watermarkShow") Да
                        button.btn.btn-primary.no(type="button", data-bind="css: {active: !u.settings.photo_show_watermark()}, click: watermarkShow") Нет

            //ko if: u.nowaterchange()
            dl.dl-horizontal: .helpexists: abbr.text-danger
                span.glyphicon.glyphicon-warning-sign
                span(data-bind="text: ' Администратор запретил ' + (itsMe()?'вам':'пользователю') + ' управлять настройками установки подписи на ' + (itsMe()?'ваших':'его') + ' фотографиях'")
            // /ko
            .watersingcontrol(data-bind="css: {deny: itsMe() && u.nowaterchange()}")
                dl.dl-horizontal
                    dt.helpexists
                        abbr(title="Поведение можно менять для каждой отдельной фотографии на странице её редактирования")
                            span.glyphicon.glyphicon-info-sign
                            |  Добавлять по-умолчанию подпись
                            br
                            |  на вотермарк загружаемых мной фотографий
                    dd: span(data-bind="css: {'panel-block': !!u.settings.photo_watermark_add_sign()}")
                        .btn-group.btn-group-sm
                            button.btn.btn-primary.yes(type="button", data-bind="css: {active: !!u.settings.photo_watermark_add_sign()}, click: watersignAdd") Да
                            button.btn.btn-primary.no(type="button", data-bind="css: {active: !u.settings.photo_watermark_add_sign()}, click: watersignAdd") Нет
                        // ko if: !!u.settings.photo_watermark_add_sign()
                        br
                        .radio(style="margin-top: 13px"): label
                            input(type="radio", name="watersign", value="true", data-bind="checked: watersigncheck")
                            | Настройки системы (
                            span(style="color:#777", data-bind="text: 'uploaded by ' + u.login()")
                            | )
                        .radio(style="margin-top:0"): .input-group(style="max-width:500px")
                            input(type="radio", name="watersign", value="custom", data-bind="checked: watersigncheck")
                            span.input-group-addon Текст
                            input.form-control(type="text", maxlength="65", data-bind="attr: {disabled: watersigncheck()!=='custom'}, value: u.watersignCustom, valueUpdate: 'afterkeydown', executeOnEnter: watermarkCustomSave")
                            span.input-group-addon.action.save(data-bind="style: {visibility: watersignCustomChanged() ? 'visible' : 'hidden'}, click: watermarkCustomSave")
                                span.glyphicon.glyphicon-ok
                            span.input-group-addon.action.cancel(data-bind="style: {visibility: watersignCustomChanged() ? 'visible' : 'hidden'}, click: watermarkCustomCancel")
                                span.glyphicon.glyphicon-remove
                        // /ko

                dl.dl-horizontal
                    dt.helpexists
                        abbr(title="Сбросить установленные в конкретных фотографиях индивидульные настройки подписи (если такие устанавливались). В этом случае при следующей конвертации фотографий, будут использованы настройки подписи, указанные в вышестоящей настройке")
                            span.glyphicon.glyphicon-info-sign
                            |  Сбросить установленные в конкретных
                            br
                            |  фотографиях индивидульные
                            br
                            | настройки подписи
                    dd: span.panel-block(style="padding-top:0")
                        div
                            label.radio-inline
                                input(type="radio", name="resetwatersign", value="all", data-bind="checked: resetwatersigncheck")
                                | Всем моим фотографиям
                            label.radio-inline
                                input(type="radio", name="resetwatersign", value="region", data-bind="checked: resetwatersigncheck")
                                span
                                    | В регионе
                                    input.form-control(id="resetwatersignRegion", data-bind="attr: {disabled: resetwatersigncheck()!=='region'}", style="display:inline-block;margin-left:6px;width:180px;", type="number", placeholder="Введите номер региона", maxlength="6")
                        div: button.btn.btn-sm.btn-primary(type="button", style="margin: 5px 0 8px;", data-bind="click: watersignReset") Сбросить

                dl.dl-horizontal
                    dt.helpexists
                        abbr(title="Отправить на конвертацию свои фотографии")
                            span.glyphicon.glyphicon-info-sign
                            |  Переконвертировать мои фотографии
                    dd: span.panel-block(style="padding-top:0")
                        div
                            label.radio-inline
                                input(type="radio", name="reconvert", value="all", data-bind="checked: reconvertcheck")
                                | Все
                            label.radio-inline
                                input(type="radio", name="reconvert", value="region", data-bind="checked: reconvertcheck")
                                span
                                    | В регионе
                                    input.form-control(id="reconvertRegion", data-bind="attr: {disabled: reconvertcheck()!=='region'}", style="display:inline-block;margin-left:6px;width:180px;", type="number", placeholder="Введите номер региона", maxlength="6")
                        div: button.btn.btn-sm.btn-pr imary(type="button", style="margin: 5px 0 8px;", data-bind="click: reconvertPhotos") Отправить

    .panel.panel-pastvu
        .panel-heading: .panel-title: a(data-toggle="collapse", href="#notice") Подписка и уведомления
        .panel-collapse.collapse.in#notice: .panel-body
            dl.dl-horizontal
                dt.helpexists
                    abbr(title="Исходное состояние опции «Подписаться на тему» при отправке комментария")
                        span.glyphicon.glyphicon-info-sign
                        |  Автоподписка при комментировании темы
                dd
                    .btn-group.btn-group-sm
                        button.btn.btn-primary.yes(type="button", data-bind="css: {active: u.settings.subscr_auto_reply()}, click: autoReply") Да
                        button.btn.btn-primary.no(type="button", data-bind="css: {active: !u.settings.subscr_auto_reply()}, click: autoReply") Нет
            dl.dl-horizontal
                dt.helpexists
                    abbr(title="Минимальное время, которое должно пройти между отправками писем с уведомлением")
                        span.glyphicon.glyphicon-info-sign
                        |  Минимальный интервал между отправками
                dd.throttle(data-bind="foreach: vars.subscr_throttle")
                    label.radio-inline
                        input(type="radio", name="subscr_throttle_radios", data-bind="attr: {id: 'subscr_throttle_radios_' + $index(), value: ''+$data}, checked: $parent.u.settings.subscr_throttle")
                        span(data-bind="text: ($data/60000 > 59 ? $data/3600000 + 'ч' : $data/60000 + 'мин')")
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br
    br