.mapModuleWrapper(data-bind="with: repository[M!M]")
	.mapContainer(data-bind="css: {embedded: embedded()}")
		.map
		.mapYearSelector
			.mapYearInner
			.mapYearOuter.L
			.mapYearOuter.R
			.mapYearHandle.L.draggable
			.mapYearHandle.R.draggable
		.mapNavigation.mContainer.mHidden
		label.checkbox.linkOpenMode
			input(type="checkbox", data-bind="checked: openNewTab")
			| Open links in new tab
		.layersPanel.fringe(data-bind="css: {open: layersOpen()}")
			.currentLayer(data-bind="text: layerActiveDesc(), click: toggleLayers")
			.layerSystems(data-bind="style: {width: (104 * (layersOpen() ? layers().length : 1)) + 'px'}")
				.h_separator
				//ko foreach: {data: $data.layers, as: 'system'}
				.layerSystem(data-bind="css: {selected: system.selected()}")
					.layerHead(data-bind="text: system.desc")
					//ko foreach: {data:system.types, as: 'type'}
					.layerType(data-bind="css: {selected: type.selected()}, text: type.desc, click: function () {$parents[1].selectLayer(system.id, type.id)}")
					// /ko
				// /ko
