#auth_curtain(data-bind="with: repository[M!M]")

	//ko if: mode()
	form.fringe(action='', autocomplete="on", method='POST', data-bind="attr: {name: mode() + 'Form'}, css: {working: working(), finish: finish()}, event: {submit: submit}")
		//ko template: {name: mode() + 'Tpl'}
		// /ko
	// /ko

	script(id="loginTpl", type="text/html")
		.head Авторизация
		.form-group
			dl.dl-horizontal
				dt Имя пользователя:
				dd
					span(data-bind="click: function () {mode('reg')}") Регистрация
			.inputwrap.user
				input.form-control(autocomplete="on", type="text", required="required", placeholder="Enter username or e-mail", name="login", autocorrect="off", autocapitalize="off")
		.form-group
			dl.dl-horizontal
				dt Пароль:
				dd
					span(data-bind="click: function () {mode('recallRequest')}") Восстановить пароль
			.inputwrap.lock
				input.form-control(type="password", required="required", placeholder="Enter password", name="pass", data-bind="event: {keypress: pressHandler}"))
			.footnote
				| Если вы были зарегистрированы на проектах oldmos или oldsp, воспользуйтесь&nbsp;
				span.lll(data-bind="click: function () {mode('recallRequest')}") формой восстановления пароля
		.form-group
			dl.dl-horizontal
				dt.checked#remember(onclick="this.classList.toggle('checked')") Запомнить меня
				dd.cantLoging
					a(href="", target="_blank", onclick="ga('send', 'event', 'support', 'click', 'support click login'); $(this).attr('href', 'mailto:support@pastvu.com?Subject=%5BНе%20могу%20войти%5D%20' + $(this).parents('form').find('[name=login]').val())")
						| Не можете войти?
			.text-warning.caps-warn(data-bind="style: {height: caps() ? '20px' : '0px'}")
				span.glyphicon.glyphicon-warning-sign
				|  Caps Lock активен
			.mess
				div(data-bind="text: msg()")
			.row.btnsAction
				.col-xs-6
					button.btn.btn-primary(type="submit") Вход
				.col-xs-6.colright
					button.btn.btn-primary(type="button", data-bind="click: formClose") Отмена

	script(id="regTpl", type="text/html")
		.head Регистрация
		.form-group
			dl.dl-horizontal
				dt Имя пользователя:
				dd
					span(data-bind="click: function () {mode('login')}") Авторизация
			.inputwrap.user
				input.form-control(autocomplete="off", type="text", required="required", placeholder="User", name="login", autocorrect="off", autocapitalize="off")
		.form-group
			dl.dl-horizontal
				dt E-mail:
				dd
			.inputwrap.envelope
				input.form-control(autocomplete="on", type="email", required="required", placeholder="email", name="email", autocorrect="off", autocapitalize="off")
		.form-group
			dl.dl-horizontal
				dt Пароль:
				dd
			.inputwrap.lock
				input.form-control(autocomplete="off", type="password", required="required", placeholder="Enter password", name="pass", data-bind="event: {keypress: pressHandler}"))
		.form-group
			dl.dl-horizontal
				dt Повторите пароль:
				dd
			.inputwrap.lock
				input.form-control(autocomplete="off", type="password", required="required", placeholder="Enter password", name="pass2", data-bind="event: {keypress: pressHandler}"))
		.form-group
			.text-warning.caps-warn(data-bind="style: {height: caps() ? '20px' : '0px'}")
				span.glyphicon.glyphicon-warning-sign
				|  Caps Lock активен
			.mess
				div(data-bind="text: msg()")
			.row.btnsAction
				.col-xs-6
					button.btn.btn-primary(type="submit") Отправить
				.col-xs-6.colright
					button.btn.btn-primary(type="button", data-bind="click: formClose") Отмена
			.row.btnsFinish
				.col-xs-12.colcent
					button.btn.btn-primary(type="button", data-bind="click: formClose") Завершить

	script(id="recallRequestTpl", type="text/html")
		.head Восстановление пароля
		.form-group
			dl.dl-horizontal
				dt Имя пользователя или e-mail:
				dd
					span(data-bind="click: function () {mode('login')}") Авторизация
			.inputwrap.user
				input.form-control(autocomplete="off", type="text", required="required", placeholder="Enter username or e-mail", name="login", autocorrect="off", autocapitalize="off")
		.form-group
			.mess
				div(data-bind="text: msg()")
			.row.btnsAction
				.col-xs-6
					button.btn.btn-primary(type="submit") Отправить
				.col-xs-6.colright
					button.btn.btn-primary(type="button", data-bind="click: formClose") Отмена
			.row.btnsFinish
				.col-xs-12.colcent
					button.btn.btn-primary(type="button", data-bind="click: formClose") Завершить

	script(id="recallRequestForMeTpl", type="text/html")
		.head Запрос нового пароля
		div(style="text-align: center; max-width: 350px; margin-bottom: 10px;")
			| На почту придет письмо со ссылкой на установку нового пароля без ввода текущего. Отправить запрос?
		.mess
			div(data-bind="text: msg()")
		.row.btnsAction
			.col-xs-6
				button.btn.btn-primary(type="submit") Отправить
			.col-xs-6.colright
				button.btn.btn-primary(type="button", data-bind="click: formClose") Отмена
		.row.btnsFinish
			.col-xs-12.colcent
				button.btn.btn-primary(type="button", data-bind="click: formClose") Завершить

	script(id="passChangeRecallTpl", type="text/html")
		.userTitle.clearfix
			img.userTitlePreview(data-bind="attr: {src: avatar()}")
			.userTitleName(data-bind="text: name()")
			.userTitleLogin(data-bind="text: login()")
		.form-group
			dl.dl-horizontal
				dt Новый пароль:
				dd
			.inputwrap.lock
				input.form-control(type="password", required="required", placeholder="Enter password", name="pass", data-bind="event: {keypress: pressHandler}"))
		.form-group
			dl.dl-horizontal
				dt Повторите новый пароль:
				dd
			.inputwrap.lock
				input.form-control(type="password", required="required", placeholder="Enter password", name="pass2", data-bind="event: {keypress: pressHandler}"))
		.form-group
			.text-warning.caps-warn(data-bind="style: {height: caps() ? '20px' : '0px'}")
				span.glyphicon.glyphicon-warning-sign
				|  Caps Lock активен
			.mess
				div(data-bind="text: msg()")
			.row.btnsAction
				.col-xs-6
					button.btn.btn-primary(type="submit") Сменить
				.col-xs-6.colright
					button.btn.btn-primary(type="button", data-bind="click: formClose") Отмена
			.row.btnsFinish
				.col-xs-12.colcent
					button.btn.btn-primary(type="button", data-bind="click: formClose") Завершить

	script(id="passChangeTpl", type="text/html")
		.head Смена пароля
		dl.dl-horizontal
			dt Текущий пароль:
		.inputwrap.lock
			input.form-control(type="password", required="required", placeholder="Enter password", name="pass", data-bind="event: {keypress: pressHandler}"), autocorrect="off", autocapitalize="off")
		dl.dl-horizontal
			dt Новый пароль:
		.inputwrap.lock
			input.form-control(type="password", required="required", placeholder="Enter password", name="passNew", data-bind="event: {keypress: pressHandler}"))
		dl.dl-horizontal
			dt Повторите новый пароль:
		.inputwrap.lock
			input.form-control(type="password", required="required", placeholder="Enter password", name="passNew2", data-bind="event: {keypress: pressHandler}"))
		button.btn.btn-default.formAction(type="submit") Сменить
		button.btn.btn-default.formAction(type="button", data-bind="click: function () {formClose()}") Отмена
		button.btn.btn-default.formFinish(type="button", data-bind="click: function () {formClose()}") Завершить
		.text-warning.caps-warn(data-bind="style: {height: caps() ? '20px' : '0px'}")
			span.glyphicon.glyphicon-warning-sign
			|  Caps Lock активен
		.mess
			div(data-bind="text: msg()")

	script(id="passInputTpl", type="text/html")
		.head Верификация
		dl.dl-horizontal
			dt Введите свой пароль для подтверждения:
		.inputwrap.lock
			input.form-control(type="password", required="required", placeholder="Enter password", name="pass", data-bind="event: {keypress: pressHandler}"), autocorrect="off", autocapitalize="off")
		button.btn.btn-default.formAction(type="submit") Отправить
		button.btn.btn-default.formAction(type="button", data-bind="click: function () {formClose()}") Отмена
		.text-warning.caps-warn(data-bind="style: {height: caps() ? '20px' : '0px'}")
			span.glyphicon.glyphicon-warning-sign
			|  Caps Lock активен
		.mess
			div(data-bind="text: msg()")